<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>实验室NAS解决方案 | Licheng Wen</title> <meta name="author" content="Licheng Wen"> <meta name="description" content="Personal website of Licheng Wen, a researcher in the field of autonomous driving and multi-agent systems. "> <meta name="keywords" content="wen licheng, licheng, jekyll, academic-website, personal website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%91%A8%E2%80%8D%F0%9F%92%BB&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://wenlc.cn/blog/2020/nas/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Licheng </span>Wen</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" target="_blank" href="/assets/pdf/LichengWen_resume.pdf">CV</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">实验室NAS解决方案</h1> <p class="post-meta">November 26, 2020</p> <p class="post-tags"> <a href="/blog/2020"> <i class="fas fa-calendar fa-sm"></i> 2020 </a>   ·   <a href="/blog/tag/docker"> <i class="fas fa-hashtag fa-sm"></i> Docker</a>   <a href="/blog/tag/nas"> <i class="fas fa-hashtag fa-sm"></i> NAS</a>   <a href="/blog/tag/emby"> <i class="fas fa-hashtag fa-sm"></i> Emby</a>   <a href="/blog/tag/nextcloud"> <i class="fas fa-hashtag fa-sm"></i> NextCloud</a>   <a href="/blog/tag/cloud"> <i class="fas fa-hashtag fa-sm"></i> Cloud</a>     ·   <a href="/blog/category/%E6%95%99%E7%A8%8B"> <i class="fas fa-tag fa-sm"></i> 教程</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="影音播放-emby">影音播放 Emby</h2> <p>在<a href="https://emby.media/linux-server.html" rel="external nofollow noopener" target="_blank">这个网址</a>下载Ubuntu Server，执行</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dpkg <span class="nt">-i</span> emby-server-deb_<span class="k">*</span>.deb
</code></pre></div></div> <p>打开后自动配置在 http://localhost:8096 端口上。</p> <p>配置媒体库后，可能需要对目标目录配置至少读权限:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chown </span>emby.emby /media/sean/1TB <span class="nt">-R</span>
<span class="nb">chmod </span>755 /media/sean/1TB
</code></pre></div></div> <h3 id="破解premium版">破解Premium版：</h3> <ul> <li> <code class="language-plaintext highlighter-rouge">sudo -i</code> 切换为 <code class="language-plaintext highlighter-rouge">root</code> 用户</li> <li>使用 <code class="language-plaintext highlighter-rouge">systemctl stop emby-server.service</code> 结束 emby 进程</li> <li>使用 <code class="language-plaintext highlighter-rouge">find / -name EmbyServer</code> 找到 emby，比如这里我的 emby 所在目录为/opt/emby-server/system/</li> <li>使用 <code class="language-plaintext highlighter-rouge">wget -O /opt/emby-server/system/System.Net.Http.dll 'http://file.neko.re/EmbyCrack/unix-x64/System.Net.Http.dll' --no-check-certificate</code>（注意替换掉命令中的 emby 所在目录）下载破解程序集替换原有程序</li> <li>启动 Emby 进程 <code class="language-plaintext highlighter-rouge">systemctl start emby-server.service</code> </li> </ul> <p>PC 浏览器：安装 URLRedirector(<a href="https://chrome.google.com/webstore/detail/maolmdhneopinciaokgohljhpdedekee" rel="external nofollow noopener" target="_blank">Chrome</a>, Firefox) 插件，添加用户规则 原始地址 https://mb3admin.com ，目标地址 https://crackemby.neko.re ，然后确认并保存，别忘了勾选重定向。 在网页版设置-Premium 内输入任意字符即可。</p> <ul> <li>Android &amp; TV：使用Emby 破解版本，转自<a href="https://www.nas2x.com/threads/emby-for-androidtv-1-7-92g.1469/" rel="external nofollow noopener" target="_blank">nas2X</a>: <a href="https://wwa.lanzous.com/b0f1vlhri" rel="external nofollow noopener" target="_blank">蓝奏云下载</a> ,密码:i06m</li> <li>IOS：<a href="https://neko.re/archives/208.html" rel="external nofollow noopener" target="_blank">破解教程</a> </li> </ul> <h2 id="私有云-nextcloud">私有云 Nextcloud</h2> <p>安装Docker环境：</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-fsSL</span> https://get.docker.com | bash <span class="nt">-s</span> docker <span class="nt">--mirror</span> Aliyun
</code></pre></div></div> <p>使用helloworld环境检查：</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>docker run hello-world
</code></pre></div></div> <p>安装官方镜像并运行：</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>docker run <span class="nt">-d</span> <span class="se">\</span>
<span class="nt">-v</span> nextcloud:/var/www/html <span class="se">\</span>
<span class="nt">-v</span> apps:/var/www/html/custom_apps <span class="se">\</span>
<span class="nt">-v</span> config:/var/www/html/config <span class="se">\</span>
<span class="nt">-v</span> /media/wayne/Wayne/data:/var/www/html/data <span class="se">\ </span> <span class="c">#此处data最好也使用外面挂载</span>
<span class="nt">-v</span> /media/wayne/Wayne:/media/Wayne <span class="se">\</span>
<span class="nt">-v</span> /media/wayne/Academic:/media/Academic <span class="se">\</span>
<span class="nt">--name</span> nextcloud <span class="se">\</span>
<span class="nt">-p</span> 8080:80 nextcloud
</code></pre></div></div> <p>成功后在 http://localhost:8080 端口上运行。</p> <p>针对只能在localhost而不能在局域网下登陆的Trusted Domain问题:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#登陆docker终端</span>
<span class="nb">sudo </span>docker <span class="nb">exec</span> <span class="nt">-it</span> <span class="nt">-u</span> root nextcloud  bash
<span class="c">#登陆后</span>
vim config/config.php 一般在/var/www/html目录下
</code></pre></div></div> <p>增加<code class="language-plaintext highlighter-rouge">trusted_domains</code>如下：</p> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s1">'trusted_domains'</span> <span class="o">=&gt;</span> 
  <span class="k">array</span> <span class="p">(</span>
          <span class="mi">0</span> <span class="o">=&gt;</span> <span class="s1">'localhost:8080'</span><span class="p">,</span>
          <span class="mi">1</span> <span class="o">=&gt;</span> <span class="s1">'192.168.3.13:8080'</span><span class="p">,</span>
  <span class="p">),</span>
</code></pre></div></div> <p>无需重启即可正常。</p> <p>连接不上应用商店：</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Change line 404 in 3rdparty/guzzlehttp/guzzle/src/Handler/CurlFactory.php

increase 1000 to 10000

In lib/private/App/AppStore/Fetcher/Fetcher.php

On line 98 change the timeout from 10 to 30 or 90

in lib/private/Http/Client.php

On line 66 change the timeout from 30 to 90

These changes migh work for you if your connection is slow. They will also invalidate the code checks so nextcloud will complain on the update page.
</code></pre></div></div> <h2 id="相册piwigo">相册Piwigo</h2> <p>安装docker-compose</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip3 <span class="nb">install </span>docker-compose
</code></pre></div></div> <p>下载Piwigo:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@github.com:xmanyou/piwigo-docker.git
</code></pre></div></div> <p>进入piwigo目录修改<code class="language-plaintext highlighter-rouge">docker-compose.yml</code></p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">3"</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">piwigo</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">linuxserver/piwigo</span>
    <span class="na">network_mode</span><span class="pi">:</span> <span class="s">bridge</span>
    <span class="na">volumes</span><span class="pi">:</span>
    <span class="c1">#这里为挂载已有相册文件夹到gallery下</span>
      <span class="pi">-</span> <span class="s">&lt;path-to-photo&gt;:/config/www/gallery/galleries/Phone_photo</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">8899:80</span>
    <span class="na">links</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">db</span>

  <span class="na">db</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">mysql:5</span>
    <span class="na">network_mode</span><span class="pi">:</span> <span class="s">bridge</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">MYSQL_USER</span><span class="pi">:</span> <span class="s2">"</span><span class="s">piwigo"</span>
      <span class="na">MYSQL_PASSWORD</span><span class="pi">:</span> <span class="s2">"</span><span class="s">piwigo"</span>
      <span class="na">MYSQL_DATABASE</span><span class="pi">:</span> <span class="s2">"</span><span class="s">piwigo"</span>
      <span class="na">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
</code></pre></div></div> <p>启动：</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker-compose up <span class="nt">-d</span>
</code></pre></div></div> <p>安装：</p> <p>镜像启动后，需要先执行Piwigo的安装，打开页面：<a href="http://localhost:8899/" rel="external nofollow noopener" target="_blank">http://localhost:8899</a></p> <p>数据库配置如下：</p> <ul> <li>数据库主机: db (注意，这里要填镜像里的service名，而不是localhost)</li> <li>数据库用户: piwigo (mysql db user)</li> <li>数据库密码: piwigo (mysql db password)</li> <li>数据库名: piwigo (mysql db name)</li> </ul> <p>管理员信息自行配置。</p> <p>点击底部安装按钮。</p> <p>同步：</p> <p>点击<code class="language-plaintext highlighter-rouge">管理员-工具-同步</code></p> </div> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2025 Licheng Wen. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme.Last updated: September 08, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js"></script> <script defer src="/assets/js/common.js"></script> <script defer src="/assets/js/copy_code.js" type="text/javascript"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-SE6TFLVDZE"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-SE6TFLVDZE");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>